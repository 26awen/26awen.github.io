## 罗技鼠标 G502 配置文件详解

### 概述

​	罗技鼠标 G502 拥有多个“可编程按键”，而且在安装**罗技游戏软件（Logitech game sofware）**的情况下可以进一步针对特定使用场景建立独立的“配置文件”。虽然从其官方宣传，以及其配套的这个软件的名称都能看到它的这些特性都是为了游戏用户，但实际上，这些特性所带来的灵活性可以被用到各种非游戏场景。

---



[TOC]

### 配置文件的分类

​	G502 的配置文件可分为两类：首先是鼠标内置的配置文件，被称为“板载配置文件”，此配置文件总共拥有三组独立的配置，可以随时切换。可以对三组配置进行不同的按键设定、不同的 DPI 分集设定，还可以进行一些个性化设置，比如每组配置可以拥有不同的 LED 灯效果。“板载配置文件”的优点是它**可以随鼠标迁移，无需安装任何软件**，因为这些设置都被保存在鼠标内，鼠标插入另一台电脑时即可使用。 

​	第二种配置文件叫做“本地配置文件”，它被安放在每一台电脑硬盘上，通过罗技游戏软件建立，不能随鼠标迁移，但是拥有更多的可定制功能，比如针对特定特定使用场景、特定软件建立独立的配置文件。

> “本地配置文件”也可以通过导出导入的操作的来迁移到其他电脑。

> 要想使用“本地配置文件”功能，必须安装官方的配套软件：[罗技游戏软件](http://support.logitech.com/en_us/software/lgs)

###  鼠标内置的“板载配置文件” 

​	进入软件界面可以看到三组板载配置，分别为“配置文件 1”、“配置文件 2”和“配置文件 3”，鼠标点击它们就可以分别对其中一组进行设定。目前的是按键设定界面。此处可以对鼠标的按键进行谁的那个，也可以对 DPI 等级进行设定。

> “配置文件 1”中，默认情况下，靠近拇指位置的那颗按键用于临时改变 DPI ，即在”分配切换功能“及”分配默认配置“所设置的两个数值间切换。松开时变回”分配默认配置“所设置的值。



> 默认情况下，滚轮后方**第二颗**按键为切换三组配置的按钮

​	“板载配置文件” 的界面：

![板载配置文件-1](../res/板载配置文件-1.jpg)



### 电脑端的“本地配置文件”

​	从软件界面布局上也能反映出两种配置文件的区别，”本地配置文件“可以针对不同软件监理独立的配置文件。另外在左侧可以看到一个命令列表窗口，可以添加自己的按键命令。

> 也就是说，由于是在电脑硬盘上，于是可以创建和存放出多余的命令，这些命令不必立即”装备“到鼠标按键上，等需要的时候再替换即可。这点也是”板载配置文件“做不到的，可能的原因是鼠标内没有多余的空间存放多余的命令，因此在”板载配置文件“情况下，只允许立即替换某一个按键的功能（命令）。

​	”本地配置文件“的界面：

![本地配置文件](../res/本地配置文件.JPG)



### 两种配置文件的区别和优略

​	在设定按键命令方面，两种配置文件几乎是相同的。此处以”板载配置文件“为例介绍在两种配置文件下的**两种通用设置**（”本地配置文件“中无非是多了更多命令及其他功能）：

1. “按键”设置

   - 在设置界面双击一个鼠标的按键，就能进入对它的设置，所谓“按键”设置就类似于平时使用的软件快捷键，比如可以把一个鼠标按键设置为`Ctrl c/v` 来使用复制及黏贴功能。（板载配置中预设了一些此类按键组合，可以选用。本地配置时可在“热键”列表中找到）

2. 多建设置

   - 多键功能则相当于一组宏按键，即触发后会模拟一组键盘输入。你如在 Excel 软件中，你要让一个单元格进入编辑状态，再在它的最前面加入一个等于，再按下“回车”进行确认，这样可以把一个公式变成一个计算结果。要设置这样一组按键宏，进入到一个按键的设置界面，选择“多键”，点击开始录制，并安顺序输入整个事件中需要输入的所有按键，再点击“停止录制”即可。

   ![录制多键](../res/录制多键.gif)

   > 在任何地方右击就可以插入更多录制内容。

   ![使用多键](../res/Lua模拟多键.gif)



### 针对特定（游戏）软件的配置文件

​	在“本地配置文件”情况下，可以针对特定的软件建立独立的配置文件，该文件是保存在电脑硬盘中的，如需在不同电脑中使用，是可以采取“导出/导入”操作，但是是比较繁琐的。

​	该种配置文件只在指定软件处于激活状态时才起作用。处于“非激活状态时”，鼠标的各按键功能又会切换回“默认配置文件”中的功能。“特定配置文件”功能通常被用在游戏中（并且官方也提供了一些主流游戏的配置好的基础文件下载）。不过在其他软件应用中也可发挥作用。

![特定配置文件](../res/特定配置文件.JPG)



### Lua 脚本的简单使用

​	以上所说的实现单一功能的“按键”设定，实现按键宏功能的“多件”设定，以及针对特定软件建立“特定配置文件”，这三种按键配置方式已经可以提供很大的灵活性，为操作提供足够的便捷性。

​	要实现更微妙的功能可能需要借助官方提供的 Lua 脚本接口。但是也只能在“本地配置文件”情况下使用。

#### 一个简单的例子

​	点击任何一个配置文件的下拉菜单，选择“编辑脚本”即可打开脚本编辑功能。脚本是基于“事件”执行的，当一件事情发生了，就会触发预先编写好的脚本，比如，一个配置文件被激活时、一个鼠标按键被按下或者抬起时。如下面的代码，会在当鼠标左键被按下时发送一个字符“a”输入，即模拟一个键盘入“a”。可在记事本中检验。

```lua
function OnEvent(event, arg)
	if (event == "MOURSE_BUTTON_PRESSED" and arg == 7) then
    	PressAndReleaseKey("a");
    end
 end
-- event 表示各类事件，arg 表示该事件的参数。
-- 对于 MOURSE_BUTTON_PRESSED 事件来说，它还需传入一个鼠标按键的编号，具体可在官方 API 手册中查阅。
```

​	或者，可以编写出类似一组“多键”命令的脚本，比如下面的代码就实现了提到的为 Excel 计算公式添加一个等于号的功能。

```lua
function OnEvent(event, arg)
	if (event == "MOUSE_BUTTON_PRESSED" and arg == 7) then
		PressAndReleaseKey("f2");
		PressAndReleaseKey("home");
		PressAndReleaseKey("equal");
		PressAndReleaseKey("enter");
		--PressAndReleaseKey("a");
	end
end
```

> Lua 脚本与“按键”及“多键”设定的功能会产生冲突。在编写脚本时需要避免这一情况，或者直接可以把一个按键“取消分配”，然后用作专门触发 Lua 脚本的按键。

#### 查看 API 手册

​	简短的 API 手册中有包含了所有可用的函数及变量，以及附带示例代码，在脚本编辑界面点击“帮助”，选择“编写 API 脚本”即可查阅。

![Lua手册](../res/查看API.JPG)



### “G 切换”的使用

​	“G 切换”开关的概念可以类比为键盘上的`shift`键，即当按下时，原来的按键变为另一个按键，“G 切换”可以让每个按键拥有两个命令（在一个配置文件中）。**虽然必须首先牺牲掉一个键，把它设定为“G 切换”开关按键。**

- 设置开关按键：无论什么情况下，只要把一个按键的命令设定为”鼠标功能“命令列表中的”G 切换“即可。

- 为“G 切换状态”下的按键设置命令：“G 切换状态”下，配置命令的方法是与正常状态下是完全一致的。



### 细节问题

#### ”板载配置文件“与”本地配置文件“的联系

​	罗技游戏软件**仅在初始化**”本地配置文件“时，会把”板载配置文件“的第一组拷贝为”本地配置文件“的”默认配置文件“，但在这之后两者是独立存在的，即，改变其中一个设置不再会影响到另一个。

#### 特定软件的配置文件、默认配置文件、永久配置文件的优先级

​	“特定配置文件”只会在特定软件激活时才有效，除非该配置文件被设置为“永久配置文件”。特定软件在非激活状态下，“永久配置文件”的优先级高于“默认配置文件”。

​	为特定软件建立“特定配置文件”后，即便某个按键为分配命令，该按键也不会调用“默认配置文件”所配置的命令。

#### 当针对某一程序建立两个配置文件的情况（未进一步验证）

​	以建立先后顺序为准，即首先建立的配置文件发挥作用，后建立的文件无效。（即便第一个文件中的某个按键未风分配命令，也不会使用第二个配置文件中的设定）

#### Lua 脚本的效果范围及个配置文件中脚本的优先级（未进一步验证）

​	通过软件设定的按键命令优先级高于通过 Lua 脚本发出的模拟按键。

​	各类型脚本的优先级可理解为：

​	①在非特定软件下：“永久性配置文件” > "默认配置文件"

​	②在特定软件下：“永久性配置文件” > “特定配置文件” > "默认配置文件"

#### 11个可编程按键

​	"滚轮后方的第一个按键"不是可编程按键，它只用于切换滚轮的”正常模式“与”快速模式“。所谓”11个可编程按键“具体是指：

1. 鼠标左键
2. 鼠标右键
3. 鼠标中间（垂直按压）
4. 鼠标中间（向左拨动）
5. 鼠标中间（向右拨动）
6. 紧挨着”鼠标左键“的`2`个按键
7. 鼠标左侧`2`个长条形按键
8. 鼠标左侧，靠近拇指处的按键
9. 滚轮后方的第二个按键

#### 可编程按键与可模拟按压的区别（尤其在 Lua 脚本中的概念）

​	G 502 拥有 11 颗可编程按键，通过在官方提供的软件中设置以及编写 Lua 脚本都可以对这些案件惊醒命令的设定和配置。（11 颗可编程按键的对应代码可查看官方 API 手册）

​	所谓“可模拟按压”是通过设定，当按下特定按键时发出一连串按键（可以是键盘或者鼠标的按键），比如可以设定当按下鼠标左键时，输入“abcd”这几个字母，也可以设定当按下鼠标左键时，输入“鼠标中键”或者“鼠标中间”等。（可被模拟的鼠标及键盘按键可查看官方 API 手册）

#### 使用”本地配置文件“的命令列表（以及通过拖拽设定命令）

​	在“本地配置文件”情况下，会有更多的命令选择。一个小技巧：通过鼠标拖拽，可以将已建立的命令拖拽到某个按键上完成设定。

#### 设置效果的延迟

​	在完成一个设定后如果在试验时结果未能及时体现（比如得到的按键认为原来的老命令），这可能是设置后的延迟造成的。  

- [x] ![]()

### 其他内容

​	1. 设为“永久性配置”：可以把“特定配置文件”设置为“永久性配置文件”，使得它全局可用，并且拥有最高优先级。

​	2. 可从官方下载主流游戏的配置文件：在“本地配置文件”下，可选择“扫描新游戏”来获取一些游戏的基础配置。


​	3. 与 Autohotkey 的配合使用：AutoHotKey 具有强大的按键定义功能和其他额外功能，比如通过它启动软件。在日常使用中，可以通过两者的相互触发进一步提高灵活性。
---

<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可。 [联系我](26awen@gmail.com)